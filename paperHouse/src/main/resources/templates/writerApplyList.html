<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<head th:replace="fragments/config :: configFragment"></head>
</head>
<body>
<div align="center">
<h1>작가 등록 신청 리스트</h1>
<table border="1">
<col width="200px"><col width="200px"><col width="200px"><col width="50px">
<tr>
	<th>작가 이름</th><th>작가 소개</th><th>작가 이력</th><th><input type="checkbox" id="checkb"></th>
</tr>
<th:block th:each="writer:${alist}">
	<tr>
		<td th:text='${writer.writerName}'></td><td th:text='${writer.intro}'></td><td>${writer.history}들어갈 자리</td><td><input type="checkbox" name='ck' th:value='${writer.writerSeq}'></td>
	</tr>

</th:block>


</table>

<button type="button" id="applyBtn">작가 등록</button>
</div>
</body>

<th:block layout:fragment="script">
<script type="text/javascript">

$(document).ready(function(){
	$("#checkb").click(function(){
		if( $("#checkb").is(':checked') ){
	        $("input[type=checkbox]").prop("checked", true);
	      }else{
	        $("input[type=checkbox]").prop("checked", false);
	      }
	});
	
	$("#applyBtn").click(function(){
		var checkRow = "";
		  $( "input[name=ck]:checked" ).each (function (){
		    checkRow = checkRow + $(this).val()+"," ;
		  });
		  checkRow = checkRow.substring(0,checkRow.lastIndexOf( ","));
		  if(checkRow == ''){
			    alert("삭제할 대상을 선택하세요.");
			    return false;
		  }else{
			  if(confirm("정보를 등록 하시겠습니까?")){
				  $.ajax({
					 url:'/applyWriter',
					 type:'get',
					 data:{checklist:checkRow},
					 success:function(data){
						 if(data>0){
							 alert("등록 되었습니다");
							 location.href="/writerApplyList";
						 }
						 else{
							 alert("등록 실패");
						 }
					 },
					 error:function(){
						 alert('error');
					 }
				  });
			  }
		  }
	});
});
</script>
</th:block>

</html>